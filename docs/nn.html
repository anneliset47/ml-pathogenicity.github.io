<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="assets/css/styles.css" />
  <link href="https://cdn.jsdelivr.net/npm/boxicons@2.0.5/css/boxicons.min.css" rel="stylesheet">
  <title>Neural Networks - Annelise Thorn</title>

  <!-- MathJax for LaTeX in captions (e.g., \(W^{(1)}\)) -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(', '\\)'], ['$', '$']]
      },
      options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'] }
    };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>
  <!--===== HEADER NAVIGATION =====-->
  <header class="l-header">
    <nav class="nav bd-grid">
      <div><a href="index.html" class="nav__logo">Annelise Thorn</a></div>
    
      <div class="dropdown">
        <button class="dropbtn">Menu <i class='bx bx-chevron-down'></i></button>
        <div class="dropdown-content">
          <a href="introduction.html">Introduction</a>
          <a href="dataprep_eda.html">Data Prep/EDA</a>
          <a href="clustering.html">Clustering</a>
          <a href="pca.html">PCA</a>
          <a href="naivebayes.html">Naive Bayes</a>
          <a href="dectrees.html">Decision Tree</a>
          <a href="svms.html">SVM</a>
          <a href="nn.html">Neural Net</a>
          <a href="conclusions.html">Conclusion</a>
          <a href="aboutme.html">About Me</a>
          <a href="references.html">References</a>
        </div>
      </div>
    </nav>
  </header>

  <main class="l-main">
    <section class="section" id="nn">
      <h2 class="section-title">Neural Networks</h2>
      <div class="nn__container bd-grid">

        <h3>Overview</h3>
        <p>
          Neural Networks (NNs) are layered models that learn patterns by combining weighted inputs with nonlinear activation functions. An input layer feeds one or more hidden layers; the output layer then produces predictions. For binary classification, a common design uses ReLU in the hidden layer(s) and a Sigmoid at the output to produce a probability between 0 and 1.
        </p>

        <div style="display: flex; flex-direction: column; align-items: center; gap: 2rem;">
          <figure style="display: flex; flex-direction: column; align-items: center; max-width: 400px; margin: 0;">
            <img src="assets/img/nn1.png" alt="Basic Neural Network Diagram" style="height: auto;" loading="lazy" />
            <figcaption style="font-size: 0.95rem; color: #444; text-align: center; margin-top: 0.5rem;">
              <strong>Figure 1:</strong> A simple feedforward neural network. Inputs flow through hidden layer(s) to an output that represents a predicted probability.
            </figcaption>
          </figure>
        </div>

        <h3>Data Preparation</h3>
        <p>
          This is a supervised classification problem, so labeled data are required. Labels come from ClinVar’s <code>ClinicalSignificance</code>, simplified to a binary target: any entry containing “pathogenic” is labeled <strong>1 (Pathogenic)</strong>, otherwise <strong>0 (Non-Pathogenic)</strong>. The feature used is the gene symbol encoded as an integer (<code>Gene_encoded</code>).
          The data are split using a stratified 80/20 Train/Test split to preserve class balance. These sets are <strong>disjoint</strong> and created <strong>before</strong> modeling to avoid leakage.
        </p>

        <p>
          Download sample data:
          <a href="assets/data/train_sample.csv" target="_blank">Training sample CSV</a> ·
          <a href="assets/data/test_sample.csv" target="_blank">Test sample CSV</a>
        </p>

        <div style="display: flex; flex-direction: column; align-items: center; gap: 2rem;">
          <figure style="display: flex; flex-direction: column; align-items: center; max-width: 400px; margin: 0;">
            <img src="assets/img/train_sample.png" alt="Training set sample table" style="max-width: 100%; height: auto;" loading="lazy" />
            <figcaption style="font-size: 0.95rem; color: #444; text-align: center; margin-top: 0.5rem;">
              <strong>Figure 2a:</strong> Training set sample (disjoint from test set; stratified split).
            </figcaption>
          </figure>

          <figure style="display: flex; flex-direction: column; align-items: center; max-width: 400px; margin: 0;">
            <img src="assets/img/test_sample.png" alt="Test set sample table" style="max-width: 100%; height: auto;" loading="lazy" />
            <figcaption style="font-size: 0.95rem; color: #444; text-align: center; margin-top: 0.5rem;">
              <strong>Figure 2b:</strong> Test set sample (held out for unbiased evaluation).
            </figcaption>
          </figure>
        </div>

        <h3>Code</h3>
        <p>
          The NN is implemented in Python with TensorFlow/Keras. Hidden layers use ReLU activations and the output layer uses Sigmoid for binary classification. The model is trained with Adam (learning rate = <code>0.001</code>) using binary cross-entropy for <code>20</code> epochs (batch size <code>16</code>). After training, performance is evaluated on the held-out test set, and figures are saved for the confusion matrix and the last 5 training epochs.
        </p>
        <p>
          <a href="https://github.com/anneliset47/annelisethorn.github.io/blob/main/Code/nn.py" target="_blank">View code on GitHub</a>
        </p>

        <h3>Results</h3>
        <div style="display: flex; flex-direction: column; align-items: center; gap: 2rem;">

          <figure style="display: flex; flex-direction: column; align-items: center; max-width: 600px; margin: 0;">
            <img src="assets/img/nn_confusionmatrix.png" alt="Neural Network Confusion Matrix" style="max-width: 100%; height: auto;" loading="lazy" />
            <figcaption style="font-size: 0.95rem; color: #444; text-align: center; margin-top: 0.5rem;">
              <strong>Figure 3:</strong> Confusion matrix (threshold = 0.5). Overall accuracy: 85%. All 17 Pathogenic were correctly identified; 3 Non-Pathogenic were predicted as Pathogenic.
            </figcaption>
          </figure>

          <figure style="display: flex; flex-direction: column; align-items: center; max-width: 400px; margin: 0;">
            <img src="assets/img/nn_last5_loss.png" alt="Training loss last 5 epochs" style="max-width: 100%; height: auto;" loading="lazy" />
            <figcaption style="font-size: 0.95rem; color: #444; text-align: center; margin-top: 0.5rem;">
              <strong>Figure 4a:</strong> Training loss for the last 5 epochs. Optimizer: Adam (lr=0.001); Loss: Binary Cross-Entropy.
            </figcaption>
          </figure>

          <figure style="display: flex; flex-direction: column; align-items: center; max-width: 400px; margin: 0;">
            <img src="assets/img/nn_last5_accuracy.png" alt="Training accuracy last 5 epochs" style="max-width: 100%; height: auto;" loading="lazy" />
            <figcaption style="font-size: 0.95rem; color: #444; text-align: center; margin-top: 0.5rem;">
              <strong>Figure 4b:</strong> Training accuracy for the last 5 epochs. Hidden activation: ReLU; Output activation: Sigmoid.
            </figcaption>
          </figure>

          <figure style="display: flex; flex-direction: column; align-items: center; max-width: 900px; margin: 0;">
            <img src="assets/img/nn_architecture.png" alt="Neural network architecture diagram" style="max-width: 100%; height: auto;" loading="lazy" />
            <figcaption style="font-size: 0.95rem; color: #444; text-align: center; margin-top: 0.5rem;">
              <strong>Figure 5:</strong> Architecture used: Input (<code>Gene_encoded</code>) → Dense(64, ReLU) → Dense(32, ReLU) → Dense(1, Sigmoid). Weight matrices \(W^{(1)}, W^{(2)}, W^{(3)}\) and biases \(b^{(1)}, b^{(2)}, b^{(3)}\) connect layers.
            </figcaption>
          </figure>
        </div>

        <h3>Conclusions</h3>
        <p>
          Using a single categorical input (<code>Gene_encoded</code>) with this NN produced 85% accuracy on the test split, driven by strong performance on the majority (Pathogenic) class and no correct detections for the minority (Non-Pathogenic) class at the default threshold. This baseline reflects limitations from both class imbalance and minimal features, and it establishes a reference point for any future extensions.
        </p>

      </div>
    </section>
  </main>

  <noscript>
    <div style="max-width: 800px; margin: 1rem auto; padding: 0.75rem; border: 1px solid #eee; color: #555;">
      Math notation requires JavaScript. Enable it to render \(W^{(1)}\) etc.
    </div>
  </noscript>

  <script src="https://unpkg.com/scrollreveal"></script>
  <script src="assets/js/main.js"></script>
</body>
</html>
